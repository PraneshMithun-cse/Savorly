<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Cart | Savourly</title>
    <meta name="description" content="Review your meal plan selections and proceed to checkout.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="assets/css/cart.css">
</head>

<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="logo"><img src="assets/images/savourly-logo-new.png" alt="Savourly"
                    class="logo-img"></a>
            <div class="nav-actions">
                <a href="index.html" class="btn btn-outline">‚Üê Back to Shop</a>
            </div>
        </div>
    </nav>

    <main class="cart-page">
        <div class="cart-container">
            <div class="cart-header">
                <h1 class="cart-title">Your Cart</h1>
                <p class="cart-subtitle" id="cartSubtitle">Review your meal plan selections</p>
            </div>

            <div class="cart-content">
                <!-- Cart Items Section -->
                <div class="cart-items-section">
                    <div class="cart-items-list" id="cartItemsList">
                        <!-- Items will be dynamically loaded -->
                    </div>

                    <!-- Delivery Address Section -->
                    <div class="delivery-address-section" id="deliveryAddressSection">
                        <h3 class="section-heading">Delivery Address</h3>

                        <!-- Saved Address Cards (populated by JS) -->
                        <div class="saved-address-cards" id="savedAddressCards">
                            <!-- JS will render saved address cards here -->
                        </div>

                        <!-- Add New Address Button -->
                        <button class="add-new-address-btn" id="addNewAddressBtn" type="button">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19" />
                                <line x1="5" y1="12" x2="19" y2="12" />
                            </svg>
                            Add New Address
                        </button>

                        <!-- Inline Add Address Form (hidden by default) -->
                        <div class="inline-address-form" id="inlineAddressForm" style="display:none;">
                            <div class="address-form-header">
                                <h4>Add Delivery Address</h4>
                                <button type="button" class="use-location-btn" id="cartUseLocationBtn">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <circle cx="12" cy="12" r="3" />
                                        <path d="M12 2v4M12 18v4M2 12h4M18 12h4" />
                                    </svg>
                                    Use My Location
                                </button>
                            </div>
                            <div class="address-form-grid">
                                <div class="form-field">
                                    <label for="cartAddrName">Name *</label>
                                    <input type="text" id="cartAddrName" placeholder="Your full name" required>
                                </div>
                                <div class="form-field">
                                    <label for="cartAddrPhone">Contact Number *</label>
                                    <input type="tel" id="cartAddrPhone" placeholder="+91 XXXXX XXXXX" required>
                                </div>
                                <div class="form-field">
                                    <label for="cartAddrHouse">House no. / Building name *</label>
                                    <input type="text" id="cartAddrHouse" placeholder="e.g. 12A, Sunshine Apartments">
                                </div>
                                <div class="form-field">
                                    <label for="cartAddrRoad">Road name / Area / Colony *</label>
                                    <input type="text" id="cartAddrRoad" placeholder="e.g. MG Road, Koramangala">
                                </div>
                                <div class="form-field">
                                    <label for="cartAddrPincode">Pincode *</label>
                                    <input type="text" id="cartAddrPincode" placeholder="e.g. 560001" maxlength="6">
                                </div>
                                <div class="form-field">
                                    <label for="cartAddrCity">City *</label>
                                    <input type="text" id="cartAddrCity" placeholder="e.g. Chennai">
                                </div>
                                <div class="form-field">
                                    <label for="cartAddrState">State</label>
                                    <select id="cartAddrState">
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Other">Other</option>
                                    </select>
                                </div>
                                <div class="form-field">
                                    <label for="cartAddrLandmark">Nearby Famous Place (optional)</label>
                                    <input type="text" id="cartAddrLandmark" placeholder="e.g. Near City Mall">
                                </div>
                            </div>
                            <!-- Address Label -->
                            <div class="address-label-picker">
                                <span>Save as</span>
                                <div class="label-options" id="cartLabelOptions">
                                    <button type="button" class="label-btn active" data-label="Home">üè† Home</button>
                                    <button type="button" class="label-btn" data-label="Work">üè¢ Work</button>
                                    <button type="button" class="label-btn" data-label="Other">üìç Other</button>
                                </div>
                            </div>
                            <button type="button" class="save-address-btn" id="saveCartAddressBtn">
                                Save Address and Continue
                            </button>
                        </div>

                        <!-- Hidden fields for checkout (populated by JS) -->
                        <input type="hidden" id="userName">
                        <input type="hidden" id="userPhone">
                        <input type="hidden" id="userAddress">
                    </div>

                    <!-- Payment Methods Section -->
                    <div class="payment-methods-section" id="paymentMethodsSection">
                        <h3 class="section-heading">Payment Method</h3>
                        <div class="payment-options">
                            <label class="payment-option active" data-method="cod">
                                <input type="radio" name="paymentMethod" value="cod" checked>
                                <div class="payment-icon">üíµ</div>
                                <div class="payment-info">
                                    <strong>Cash on Delivery</strong>
                                    <span>Pay when you receive</span>
                                </div>
                                <div class="payment-check">‚úì</div>
                            </label>
                            <label class="payment-option" data-method="gpay">
                                <input type="radio" name="paymentMethod" value="gpay">
                                <div class="payment-icon gpay-icon">
                                    <svg viewBox="0 0 24 24" width="28" height="28">
                                        <path fill="#4285F4"
                                            d="M12.545 10.239v3.821h5.445c-.239 1.487-1.789 4.359-5.445 4.359-3.273 0-5.946-2.711-5.946-6.043s2.673-6.043 5.946-6.043c1.865 0 3.113.795 3.828 1.481l2.606-2.51C17.094 3.577 14.989 2.619 12.545 2.619 6.979 2.619 2.545 7.053 2.545 12.619s4.434 10 10 10c5.77 0 9.593-4.054 9.593-9.769 0-.657-.072-1.159-.158-1.659H12.545z" />
                                    </svg>
                                </div>
                                <div class="payment-info">
                                    <strong>Google Pay</strong>
                                    <span>UPI Payment</span>
                                </div>
                                <div class="payment-check">‚úì</div>
                            </label>
                            <label class="payment-option" data-method="phonepe">
                                <input type="radio" name="paymentMethod" value="phonepe">
                                <div class="payment-icon phonepe-icon">
                                    <svg viewBox="0 0 24 24" width="28" height="28">
                                        <circle cx="12" cy="12" r="10" fill="#5F259F" />
                                        <path fill="#fff" d="M8 7h3l4 5-4 5H8l4-5-4-5z" />
                                    </svg>
                                </div>
                                <div class="payment-info">
                                    <strong>PhonePe</strong>
                                    <span>UPI Payment</span>
                                </div>
                                <div class="payment-check">‚úì</div>
                            </label>
                            <label class="payment-option" data-method="upi">
                                <input type="radio" name="paymentMethod" value="upi">
                                <div class="payment-icon upi-icon">
                                    <svg viewBox="0 0 24 24" width="28" height="28">
                                        <rect width="24" height="24" rx="4" fill="#fff" />
                                        <path fill="#097939" d="M4 8h4l6 8H8L4 8z" />
                                        <path fill="#ED752E" d="M10 8h4l6 8h-4l-6-8z" />
                                    </svg>
                                </div>
                                <div class="payment-info">
                                    <strong>UPI ID</strong>
                                    <span>Pay via any UPI app</span>
                                </div>
                                <div class="payment-check">‚úì</div>
                            </label>
                        </div>
                        <div class="upi-input-section" id="upiInputSection" style="display: none;">
                            <input type="text" id="upiId" placeholder="Enter your UPI ID (e.g. name@upi)">
                        </div>
                    </div>
                </div>

                <!-- Order Summary Section -->
                <div class="order-summary-section">
                    <div class="order-summary-card">
                        <h2 class="summary-title">Order Summary</h2>

                        <!-- Coupon Section -->
                        <div class="coupon-section">
                            <div class="coupon-input-wrapper">
                                <input type="text" id="couponInput" class="coupon-input"
                                    placeholder="Enter coupon code">
                                <button class="coupon-apply-btn" id="applyCouponBtn">Apply</button>
                            </div>
                            <p class="coupon-message" id="couponMessage"></p>
                            <div class="coupon-applied" id="couponApplied" style="display: none;">
                                <span class="coupon-tag">
                                    <span id="appliedCouponCode"></span>
                                    <button class="remove-coupon" id="removeCouponBtn">√ó</button>
                                </span>
                            </div>
                        </div>

                        <div class="summary-divider"></div>

                        <!-- Summary Details -->
                        <div class="summary-row">
                            <span>Subtotal</span>
                            <span id="subtotalAmount">‚Çπ0</span>
                        </div>
                        <div class="summary-row discount-row" id="discountRow" style="display: none;">
                            <span>Discount</span>
                            <span class="discount-amount" id="discountAmount">-‚Çπ0</span>
                        </div>
                        <div class="summary-row">
                            <span>Delivery</span>
                            <span class="free-delivery">FREE</span>
                        </div>

                        <div class="summary-divider"></div>

                        <div class="summary-row total-row">
                            <span>Total</span>
                            <span class="total-amount" id="totalAmount">‚Çπ0</span>
                        </div>
                        <p class="per-week-text">per week</p>

                        <button class="checkout-btn-main" id="checkoutBtnMain">
                            <span>Proceed to Payment</span>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M5 12h14M12 5l7 7-7 7" />
                            </svg>
                        </button>

                        <div class="secure-checkout">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                                <path d="M7 11V7a5 5 0 0110 0v4" />
                            </svg>
                            <span>Secure Checkout</span>
                        </div>
                    </div>

                    <!-- Promo Banner -->
                    <div class="promo-banner">
                        <div class="promo-icon">üéâ</div>
                        <div class="promo-text">
                            <strong>Try SAVE20</strong>
                            <span>Get 20% off on your first order!</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Empty Cart State -->
            <div class="empty-cart" id="emptyCart" style="display: none;">
                <div class="empty-cart-icon">
                    <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="1.5">
                        <circle cx="9" cy="21" r="1" />
                        <circle cx="20" cy="21" r="1" />
                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6" />
                    </svg>
                </div>
                <h2>Your cart is empty</h2>
                <p>Looks like you haven't added any meal plans yet.</p>
                <a href="index.html#plans" class="btn btn-primary">Browse Meal Plans</a>
            </div>
        </div>
    </main>

    <footer class="cart-footer">
        <p>¬© 2024 Savourly. All rights reserved.</p>
    </footer>

    <!-- Firebase SDK (needed for authenticated order POST) -->
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAbOyzOi3xqyXNLWrmkL7pqMrxk_opjW1I",
            authDomain: "savorly-d2e63.firebaseapp.com",
            projectId: "savorly-d2e63",
            storageBucket: "savorly-d2e63.firebasestorage.app",
            messagingSenderId: "820941077673",
            appId: "1:820941077673:web:feffe61f09d5970c477db8",
            measurementId: "G-E3YQ1VSL75"
        };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    </script>

    <script src="assets/js/cart.js"></script>
</body>

</html>